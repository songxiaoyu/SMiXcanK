% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/prob_posthoc.R
\name{primo_map_classify}
\alias{primo_map_classify}
\title{PRIMO MAP Classification}
\usage{
primo_map_classify(
  merged,
  pvals_names,
  type_col = "type",
  alt_props = 0.05,
  specific_label = "CellTypeSpecific",
  unspecific_label = "UnSpecific",
  ...
)
}
\arguments{
\item{merged}{A data.frame containing p-values and a type column.}

\item{pvals_names}{Character vector of column names used as PRIMO inputs.}

\item{type_col}{Character. Column name indicating specificity
(e.g. \code{"type"}, \code{"type_ct2"}).}

\item{alt_props}{Numeric scalar or numeric vector giving the prior
proportion of non-null tests for each p-value column.
If scalar, it is recycled to \code{length(pvals_names)}.}

\item{specific_label}{Character label identifying cell-type-specific rows.}

\item{unspecific_label}{Character label identifying non-specific rows.}

\item{...}{Additional arguments passed to \code{Primo::Primo_pval()}}
}
\value{
A list with:
\describe{
\item{out}{Original data.frame with posterior probabilities
(prefixed by \code{"post__"}) and a \code{MAP} column appended.}
\item{primo_specific}{PRIMO result object for specific rows (or NULL).}
\item{primo_unspecific}{PRIMO result object for non-specific rows (or NULL).}
}
}
\description{
Run PRIMO separately on cell-type-specific and non-specific rows,
then combine posterior probabilities and MAP classifications
back into the original data frame.
}
\details{
This function:
\itemize{
\item Splits rows by \code{type_col}
\item Runs PRIMO separately on specific and non-specific rows
\item Combines posterior probabilities in original row order
\item Assigns MAP class via maximum posterior probability
}

The \code{alt_props} argument represents the assumed prior proportion
of non-null tests per input p-value (see PRIMO documentation).
}
\examples{
\dontrun{
res <- primo_map_classify(
  merged,
  pvals_names = c("p_1_ct2", "p_2_ct2", "p_3"),
  type_col = "type_ct2"
)
head(res$out)
}

}
\seealso{
\code{\link[Primo]{Primo_pval}}
}
