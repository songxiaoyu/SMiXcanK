% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/prob_posthoc.R
\name{primo_map_all}
\alias{primo_map_all}
\title{PRIMO MAP Classification for Multiple P-values}
\usage{
primo_map_all(merged, pvals_names, alt_props = 0.05, prefix = "post__", ...)
}
\arguments{
\item{merged}{A data frame containing p-value columns used as PRIMO inputs.
Each row is assumed to represent a cell-type-specific signal.}

\item{pvals_names}{Character vector giving the column names of p-values
to be used as input to PRIMO. All specified columns must exist in
\code{merged}.}

\item{alt_props}{Numeric scalar or numeric vector specifying the prior
proportion of non-null tests for each p-value column. If a scalar is
supplied, it is recycled to \code{length(pvals_names)}.}

\item{prefix}{Character string used as a prefix for posterior probability
columns appended to the output. Default is \code{"post__"}.}

\item{...}{Additional arguments passed to
\code{\link[Primo]{Primo_pval}}.}
}
\value{
A list with two elements:
\describe{
\item{out}{A data frame containing the original \code{merged} data,
appended with posterior probability columns (prefixed by
\code{prefix}) and a \code{MAP} column indicating the MAP configuration
for each row.}
\item{primo}{The \code{Primo_pval} result object returned by PRIMO.}
}
}
\description{
Run \code{PRIMO} on multiple p-value columns assuming all rows correspond
to cell-type-specific signals, and assign a maximum a posteriori (MAP)
configuration to each row.
}
\details{
This function applies \code{\link[Primo]{Primo_pval}} once to all rows of
the input data frame, appends posterior probabilities for each PRIMO
latent pattern, and assigns a MAP class based on the largest posterior
probability.

For numerical stability, all p-values are internally clamped to the open
interval \eqn{(10^{-15}, 1 - 10^{-15})}. This does not affect statistical
inference and prevents failures due to exact 0 or 1 p-values.
}
\seealso{
\code{\link[Primo]{Primo_pval}}
}
